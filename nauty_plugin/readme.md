# Laman Number Library and Nauty Plugin for Maximum Laman Number
The Laman Number library (lnumber) is meant to be as an external dynamic library used by programs such as the Nauty Laman plugin. The library implements a fast algorithm that computes Laman number of a Laman graph based on our paper (with C. Koutschan, G. Grasseger, N. Lubbes, J. Schicho and M. Gallet). 

The Nauty plugin is a fork of the [Nauty-Laman plugin](https://github.com/martinkjlarsson/nauty-laman-plugin) originally written by Martin Larrson for the utility 
program `geng` provided by [Nauty](http://pallini.di.uniroma1.it/). The plugin counts the number of non-isomorphic Laman graphs of a given number of 
vertices. The quick generation of the Laman graphs was implemented by Martin Larrson. I integrated parallel computing of Laman numbers into the plugin via dependency on the lnumber library. Parallel computing is done via openmp.

## Installation with Compiling
1. Clone this repo.
2. Download and build [Nauty](http://pallini.di.uniroma1.it/).
3. Build the lnumber library.
4. `geng` has to be rebuilt 
in C++ with the flag `-D'PLUGIN="<path to this repo>/prunelaman.h"' and linking with lnumber and activating openmp. After building everything in nauty 
either use g++ to link (for Linux and Windows building with gcc/g++)
```makefile
g++  -Wno-write-strings -std=c++98 -I./ -o geng -fopenmp -O3 -s \ 
  -mpopcnt -march=native -D'PLUGIN="<path to this repo>/prunelaman.h"' \
  -DMAXN=WORDSIZE -DWORDSIZE=32 geng.c gtoolsW.o nautyW1.o nautilW1.o \
  naugraphW1.o schreier.o naurng.o  -L. -lstdc++ -lm -llnumber \
  -lgmpxx -lgomp -lgmp
```
or if you are using Windows with MSVC you can compile and link using the VS2008 project file I provided in VS2008 folder. You will need to change the directory of the dependencies in the VS2008 project file

5. Once `geng` is compiled you can run it with the parameters to compute the maximum Laman numbers (see usage)

## Installation with Prebuilt Binaries
1. Copy the files in the ./bin folder
2. Run the file geng (see usage).

## Usage
The plugin was originally developed by Martin Larrson with the following additional parameters to `geng`:
* `-K#`: generate (k,l)-tight graphs where l = k(k+1)/2. Minimum degree and number of edges will default to k and kn-l, respectively. Sparse graphs can be generated by manually providing the minimum and maximum number of edges (e.g. `0:999`). In that case, the minimum degree will default to zero.
* `-L#`: provides the l when generating (k,l)-sparse or (k,l)-tight graphs.
* `-H`: generate (k,l)-tight graphs constructible by [Henneberg type I moves](https://en.wikipedia.org/wiki/Laman_graph#Henneberg_construction). k defaults to 2 but can be set using `-K#`. l is always k(k+1)/2.
* `-N#`: all (complete graps) graphs with this number of nodes or fewer are considered (tight) sparse. The default value is max(⌊k⌋,2) or the highest n such that a complete graph on n vertices is (k,l)-sparse.

Both `-K` and `-L` accept rational numbers making it possible to generate, e.g., (3/2,2)-tight graphs (see results below). Note, however, that denominators equal to their numerator are ignored, e.g., `-K2/2` is equivalent to `-K2`. If rational arguments are not needed, define the macro `INT_KL` before compiling for a small increase in performance.

After forking the plugin, I added the following parameter:
* `-M`: computes the Laman number while each (nonisomorphic) Laman graph is generated (`-K2` must be given) and keeps the graph with maximum Laman number. The output will parse the maximum Laman number for the given number of vertices. Computation is done in parallel using openmp.

## Algorithm
The pebble game algorithm (see [Lee and Streinu (2008) Pebble game algorithms and sparse graphs](https://www.sciencedirect.com/science/article/pii/S0012365X07005602)) is used to generated the Laman graphs. While generating the graphs our algorithm (see [Capco et. al. The number of Realization of a Laman Graph](http://www.koutschan.de/data/laman/)), implemented in the lnumber library, is used in parallel to compute the Laman numbers. 

## Results -  execution times
The tables below show the execution time when generating graphs for various number of vertices n. Unless otherwise specified, the tests were run on an 6-core/12-thread Intel® Core™ i7-6800K CPU @ 3.40GHz. Extensions to entries in [OEIS](https://oeis.org/) are marked with *(new)*.

### Laman graphs
OEIS entry: [A227117](https://oeis.org/A227117 "Number of minimally rigid graphs in 2D on n vertices.")<br/>
Command: `geng $n -K2 -u`

[Laman graphs](https://en.wikipedia.org/wiki/Laman_graph), minimally rigid graphs in 2D, are exactly the (2,3)-tight graphs. When increasing n by one, for large n, the number of graphs increases by a factor of approximately 30 while the execution time increases by a factor of approximately 60. `geng` parallelizes well over physical cores but poorly over logical cores.
n                     |     11    |     12     |        13       |    14 (new)    |      15 (new)     |
----------------------|:---------:|:----------:|:---------------:|:--------------:|:-----------------:|
Laman graphs          | 2 039 273 | 44 176 717 |  1 092 493 042  | 30 322 994 747 | 932 701 249 291\* |
Exec. time (1 core)   |    11 s   |   7.7 min  |      6.6 h      |     15 days    |   *Not measured*  |
Exec. time (6 cores)  |   2.5 s   |   1.4 min  |      1.2 h      |    2.6 days    |   *Not measured*  |
Exec. time (12 cores) |   2.1 s   |   1.3 min  |      1.1 h      |    2.5 days    |   *Not measured*  |

\* Running 128 instances of `geng` on an AMD Ryzen Threadripper 3990X 64-Core Processor for 14 days.
